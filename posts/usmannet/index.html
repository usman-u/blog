<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>UsmanNet 2022 - An Overview of my Network | Usman</title><meta name=keywords content><meta name=description content="Network Infrastructure Breakdown: My network mainly consists of two Ubiquiti EdgeRouter Xs, two Cisco Catalyst switches, and a VyOS cloud VPS. WireGuard is used as the VPN tunneling protocol, to connect the Edgerouters and the Vyos VPS. I participate in the DN42 BGP project. BGP is used on edge.dn42.lan, to connect to the BGP upstream & downstream peers, providing access to the DN42 private network. OSPF is used between erx."><meta name=author content="Usman"><link rel=canonical href=https://blog.usman.network/posts/usmannet/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.usman.network/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.usman.network/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.usman.network/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.usman.network/apple-touch-icon.png><link rel=mask-icon href=https://blog.usman.network/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-KWB2M6CZK2"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-KWB2M6CZK2",{anonymize_ip:!1})}</script><meta property="og:title" content="UsmanNet 2022 - An Overview of my Network"><meta property="og:description" content="Network Infrastructure Breakdown: My network mainly consists of two Ubiquiti EdgeRouter Xs, two Cisco Catalyst switches, and a VyOS cloud VPS. WireGuard is used as the VPN tunneling protocol, to connect the Edgerouters and the Vyos VPS. I participate in the DN42 BGP project. BGP is used on edge.dn42.lan, to connect to the BGP upstream & downstream peers, providing access to the DN42 private network. OSPF is used between erx."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.usman.network/posts/usmannet/"><meta property="og:image" content="https://blog.usman.network/images/hn/cables.PNG"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-28T20:29:16+01:00"><meta property="article:modified_time" content="2022-07-28T20:29:16+01:00"><meta property="og:site_name" content="Usman"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.usman.network/images/hn/cables.PNG"><meta name=twitter:title content="UsmanNet 2022 - An Overview of my Network"><meta name=twitter:description content="Network Infrastructure Breakdown: My network mainly consists of two Ubiquiti EdgeRouter Xs, two Cisco Catalyst switches, and a VyOS cloud VPS. WireGuard is used as the VPN tunneling protocol, to connect the Edgerouters and the Vyos VPS. I participate in the DN42 BGP project. BGP is used on edge.dn42.lan, to connect to the BGP upstream & downstream peers, providing access to the DN42 private network. OSPF is used between erx."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.usman.network/posts/"},{"@type":"ListItem","position":2,"name":"UsmanNet 2022 - An Overview of my Network","item":"https://blog.usman.network/posts/usmannet/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"UsmanNet 2022 - An Overview of my Network","name":"UsmanNet 2022 - An Overview of my Network","description":"Network Infrastructure Breakdown: My network mainly consists of two Ubiquiti EdgeRouter Xs, two Cisco Catalyst switches, and a VyOS cloud VPS. WireGuard is used as the VPN tunneling protocol, to connect the Edgerouters and the Vyos VPS. I participate in the DN42 BGP project. BGP is used on edge.dn42.lan, to connect to the BGP upstream \u0026amp; downstream peers, providing access to the DN42 private network. OSPF is used between erx.","keywords":[],"articleBody":" Network Infrastructure Breakdown: My network mainly consists of two Ubiquiti EdgeRouter Xs, two Cisco Catalyst switches, and a VyOS cloud VPS. WireGuard is used as the VPN tunneling protocol, to connect the Edgerouters and the Vyos VPS. I participate in the DN42 BGP project. BGP is used on edge.dn42.lan, to connect to the BGP upstream \u0026 downstream peers, providing access to the DN42 private network. OSPF is used between erx.usman.lan, erx.zahid.lan and edge.dn42.lan, to exchange internal routes. BGP routes from DN42 are also redistributed into OSPF, at edge.dn42.lan, so that the DN42 network is accessible from the other routers. More Info: My Home LAN Ubiquiti Edgerouter X - erx.usman.lan\nWireGuard VPNs to erx.zahid.lan and dn42-vps.lan. OSPF neighbors witherx.zahid.lan and dn42-vps.lan. Source NAT on VPN interfaces, such that any outbound traffic destined for DN42, is NATed to a DN42 IP. Router-On-A-Stick VLANs - with a VLAN trunk down to the Cisco 2960G. Cisco 2960G - usman-cisco.lan\nBasic Layer 2 switching to normal end user hosts. Raspberry Pi 4 8GB - pi.usman.lan\nRunning as a host for Docker apps. WD 8TB NAS - nas.usman.lan\nSMB Shares. Plex Media Server Offsite Network Ubiquiti Edgerouter X - erx.zahid.lan\nWireGuard VPNs and OSPF area 0 to erx.usman.lan and dn42.erx.lan Source NAT on VPN interfaces, such that any outbound traffic destined for DN42, is NATed to a DN42 IP. Cisco 3560G - core.zahid.lan\nSVIs for VLANs. iBGP peering with erx.zahid.lan Raspberry Pi 4 8GB - pi.zahid.lan\nRunning as a host for Docker apps. 6TB HDD. My DN42 Node A Cloud VPS running VyOS as my DN42 Node. (See my other posts for more info about DN42). eBGP peering with three upstream DN42 providers, over point to point WireGuard VPNs. OSPF area 0 with erx.usman.lan and erx.zahid.lan. Redistributing BGP into OSPF. Filtering BGP advertisements using GoRTR RPKI ROA. Filtering BGP exports using route-maps and prefix lists, such that BGP updates from AS65535 and AS65534 aren’t advertised to DN42. Services being hosted: On the Raspberry Pi Docker Hosts: Plex Media Server Radarr, Sonarr, Jackett, qBittorrent. Nextcloud. Syncthing. NGINX Proxy Manager - routes a few of the mentioned services through Cloudfare’s WAF, for DDOS mitigation and public IP obfuscation. ","wordCount":"360","inLanguage":"en","image":"https://blog.usman.network/images/hn/cables.PNG","datePublished":"2022-07-28T20:29:16+01:00","dateModified":"2022-07-28T20:29:16+01:00","author":{"@type":"Person","name":"Usman"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.usman.network/posts/usmannet/"},"publisher":{"@type":"Organization","name":"Usman","logo":{"@type":"ImageObject","url":"https://blog.usman.network/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.usman.network/ accesskey=h title="Usman (Alt + H)">Usman</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.usman.network/dn42/ title="DN42 Peering"><span>DN42 Peering</span></a></li><li><a href=https://blog.usman.network/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.usman.network/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://blog.usman.network/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.usman.network/>Home</a>&nbsp;»&nbsp;<a href=https://blog.usman.network/posts/>Posts</a></div><h1 class=post-title>UsmanNet 2022 - An Overview of my Network</h1><div class=post-meta><span title='2022-07-28 20:29:16 +0100 +0100'>28 July, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Usman</div></header><figure class=entry-cover><img loading=lazy src=https://blog.usman.network/images/hn/cables.PNG alt=alt></figure><div class=post-content><p><img loading=lazy src=/images/hn/net_map.png alt=" Diagram"></p><hr><h2 id=network-infrastructure-breakdown>Network Infrastructure Breakdown:<a hidden class=anchor aria-hidden=true href=#network-infrastructure-breakdown>#</a></h2><ul><li>My network mainly consists of two Ubiquiti EdgeRouter Xs, two Cisco Catalyst switches, and a VyOS cloud VPS.</li><li>WireGuard is used as the VPN tunneling protocol, to connect the Edgerouters and the Vyos VPS.</li><li>I participate in the DN42 BGP project. BGP is used on <code>edge.dn42.lan</code>, to connect to the BGP upstream & downstream peers, providing access to the DN42 private network.</li><li>OSPF is used between <code>erx.usman.lan</code>, <code>erx.zahid.lan</code> and <code>edge.dn42.lan</code>, to exchange internal routes.</li><li>BGP routes from DN42 are also redistributed into OSPF, at <code>edge.dn42.lan</code>, so that the DN42 network is accessible from the other routers.</li></ul><hr><h2 id=more-info>More Info:<a hidden class=anchor aria-hidden=true href=#more-info>#</a></h2><hr><h3 id=my-home-lan>My Home LAN<a hidden class=anchor aria-hidden=true href=#my-home-lan>#</a></h3><ul><li><p>Ubiquiti Edgerouter X - <code>erx.usman.lan</code></p><ul><li>WireGuard VPNs to <code>erx.zahid.lan</code> and <code>dn42-vps.lan</code>.</li><li>OSPF neighbors with<code>erx.zahid.lan</code> and <code>dn42-vps.lan</code>.</li><li>Source NAT on VPN interfaces, such that any outbound traffic destined for DN42, is NATed to a DN42 IP.</li><li><em>Router-On-A-Stick</em> VLANs - with a VLAN trunk down to the Cisco 2960G.</li></ul></li><li><p>Cisco 2960G - <code>usman-cisco.lan</code></p><ul><li>Basic Layer 2 switching to normal end user hosts.</li></ul></li><li><p>Raspberry Pi 4 8GB - <code>pi.usman.lan</code></p><ul><li>Running as a host for Docker apps.</li></ul></li><li><p>WD 8TB NAS - <code>nas.usman.lan</code></p><ul><li>SMB Shares.</li><li>Plex Media Server</li></ul></li></ul><hr><h3 id=offsite-network>Offsite Network<a hidden class=anchor aria-hidden=true href=#offsite-network>#</a></h3><ul><li><p>Ubiquiti Edgerouter X - <code>erx.zahid.lan</code></p><ul><li>WireGuard VPNs and OSPF area 0 to <code>erx.usman.lan</code> and <code>dn42.erx.lan</code></li><li>Source NAT on VPN interfaces, such that any outbound traffic destined for DN42, is NATed to a DN42 IP.</li></ul></li><li><p>Cisco 3560G - <code>core.zahid.lan</code></p><ul><li>SVIs for VLANs.</li><li>iBGP peering with <code>erx.zahid.lan</code></li></ul></li><li><p>Raspberry Pi 4 8GB - <code>pi.zahid.lan</code></p><ul><li>Running as a host for Docker apps.</li><li>6TB HDD.</li></ul></li></ul><hr><h3 id=my-dn42-node>My DN42 Node<a hidden class=anchor aria-hidden=true href=#my-dn42-node>#</a></h3><ul><li>A Cloud VPS running <a href=https://vyos.io/>VyOS</a> as my DN42 Node. (See my <a href=https://blog.usman.network/posts/dn42-bgp/>other posts</a> for more info about DN42).</li><li>eBGP peering with three upstream DN42 providers, over point to point WireGuard VPNs.</li><li>OSPF area 0 with <code>erx.usman.lan</code> and <code>erx.zahid.lan</code>.</li><li>Redistributing BGP into OSPF.</li><li>Filtering BGP advertisements using <a href=https://dn42.eu/howto/ROA-slash-RPKI>GoRTR RPKI ROA</a>.</li><li>Filtering BGP exports using route-maps and prefix lists, such that BGP updates from <code>AS65535</code> and <code>AS65534</code> aren&rsquo;t advertised to DN42.</li></ul><hr><h3 id=services-being-hosted>Services being hosted:<a hidden class=anchor aria-hidden=true href=#services-being-hosted>#</a></h3><ul><li>On the Raspberry Pi Docker Hosts:<ul><li><a href=https://docs.linuxserver.io/images/docker-plex>Plex Media Server</a></li><li><a href=https://radarr.video/>Radarr</a>, <a href=https://sonarr.tv/>Sonarr</a>, <a href=https://github.com/Jackett/Jackett>Jackett</a>, <a href=https://hub.docker.com/r/linuxserver/qbittorrent>qBittorrent</a>.</li><li><a href=https://nextcloud.com/athome/>Nextcloud</a>.</li><li><a href=https://syncthing.net/>Syncthing</a>.</li><li><a href=https://nginxproxymanager.com/>NGINX Proxy Manager</a> - routes a few of the mentioned services through <a href=https://www.cloudflare.com/en-gb/waf/>Cloudfare&rsquo;s WAF</a>, for DDOS mitigation and public IP obfuscation.</li></ul></li></ul><hr></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://blog.usman.network/posts/bgp-rpki-roa/><span class=title>Next »</span><br><span>DN42 Part 3: BGP ROA/RPKI Filtering using Docker</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.usman.network/>Usman</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>